[0;35m========================================[0m
[0;35m用户认证与授权功能测试[0m
[0;35m========================================[0m
测试时间: Tue Oct 21 18:44:00 CST 2025
测试URL: http://localhost:8088/api
测试用户: testuser_1761043440

[0;34m=== 步骤 1: 用户注册功能测试 ===[0m
[1;33m执行测试: 用户正常注册[0m
请求: POST /register
head: illegal line count -- -1
响应状态码: 201
响应内容: 
[0;32m✓ 用户正常注册: 通过[0m
[0;36m详情: 状态码匹配: 201[0m

[1;33m执行测试: 重复用户名注册[0m
请求: POST /register
head: illegal line count -- -1
响应状态码: 409
响应内容: 
[0;31m✗ 重复用户名注册: 失败[0m
[0;36m详情: 期望状态码: 400, 实际状态码: 409[0m

[1;33m执行测试: 重复邮箱注册[0m
请求: POST /register
head: illegal line count -- -1
响应状态码: 409
响应内容: 
[0;31m✗ 重复邮箱注册: 失败[0m
[0;36m详情: 期望状态码: 400, 实际状态码: 409[0m

[1;33m执行测试: 无效数据注册[0m
请求: POST /register
head: illegal line count -- -1
响应状态码: 400
响应内容: 
[0;32m✓ 无效数据注册: 通过[0m
[0;36m详情: 状态码匹配: 400[0m


[0;34m=== 步骤 2: 用户登录功能测试 ===[0m
[1;33m执行测试: 用户正常登录[0m
登录响应: {"code":200,"message":"登录成功","data":{"email":"testuser_1761043440@example.com","token":"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkIjo2LCJ1c2VybmFtZSI6InRlc3R1c2VyXzE3NjEwNDM0NDAiLCJleHAiOjE3NjExMjk4NDAsImlhdCI6MTc2MTA0MzQ0MH0.ECueCMdc19lM24wW1WD_WD9lb45mlXNdr0ikt8sIlpY","user_id":6,"username":"testuser_1761043440"}}
[0;32m✓ 用户正常登录: 通过[0m
[0;36m详情: 成功获取JWT token[0m

JWT Token: eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJ1c2VyX2lkI...
[1;33m执行测试: 错误用户名登录[0m
请求: POST /login
head: illegal line count -- -1
响应状态码: 401
响应内容: 
[0;32m✓ 错误用户名登录: 通过[0m
[0;36m详情: 状态码匹配: 401[0m

[1;33m执行测试: 错误密码登录[0m
请求: POST /login
head: illegal line count -- -1
响应状态码: 401
响应内容: 
[0;32m✓ 错误密码登录: 通过[0m
[0;36m详情: 状态码匹配: 401[0m

[1;33m执行测试: 无效数据登录[0m
请求: POST /login
head: illegal line count -- -1
响应状态码: 400
响应内容: 
[0;32m✓ 无效数据登录: 通过[0m
[0;36m详情: 状态码匹配: 400[0m


[0;34m=== 步骤 3: JWT认证功能测试 ===[0m
[1;33m执行测试: 有效JWT访问受保护接口[0m
head: illegal line count -- -1
响应状态码: 201
响应内容: 
[0;32m✓ 有效JWT访问受保护接口: 通过[0m
[0;36m详情: 成功创建文章[0m

[1;33m执行测试: 无效JWT访问受保护接口[0m
head: illegal line count -- -1
响应状态码: 401
响应内容: 
[0;32m✓ 无效JWT访问受保护接口: 通过[0m
[0;36m详情: 正确拒绝无效token[0m

[1;33m执行测试: 无JWT访问受保护接口[0m
head: illegal line count -- -1
响应状态码: 401
响应内容: 
[0;32m✓ 无JWT访问受保护接口: 通过[0m
[0;36m详情: 正确拒绝无认证请求[0m


[0;34m=== 步骤 4: 密码加密存储验证 ===[0m
[1;33m执行测试: 密码加密存储验证[0m
注意: 此测试需要直接查询数据库验证密码是否加密存储
建议手动检查数据库中用户密码是否为加密后的哈希值
[0;31m✗ 密码加密存储验证: 失败[0m
[0;36m详情: 需要手动验证数据库中的密码字段[0m


[0;35m========================================[0m
[0;35m用户认证与授权测试总结[0m
[0;35m========================================[0m
总测试数: 12
通过: [0;32m9[0m
失败: [0;31m3[0m

[0;31m❌ 有 3 个测试失败，需要检查相关功能[0m
